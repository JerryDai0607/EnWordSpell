{"version":3,"sources":["whevent.js"],"names":["window","whevent","debugMode","logger","lastEvent","_callStacks","bind","signal","func","self","push","once","bindPriority","splice","bindOnce","bindOncePriority","unbind","i","length","undefined","destroy","call","data","console","log","eves","_processed","on","onOnce","onPriority","onOncePriority","off","emit","module","exports"],"mappings":"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","file":"whevent.js","sourceRoot":"../../../../../assets/Scripts/Libs","sourcesContent":["\r\n\r\nwindow.whevent = {\r\n\t// debug mode, the call will be printed by the logger\r\n\tdebugMode: false,\r\n\t// the logger object, used for debug mode, if not assigned, use console.log instead\r\n\tlogger: null,\r\n\t// the last event object that called\r\n\tlastEvent: null,\r\n\r\n\t_callStacks: {},\r\n\r\n\r\n\t// bind the event object\r\n\tbind: function(signal, func, self){\r\n\t\tif(!this._callStacks[signal]){\r\n\t\t\tthis._callStacks[signal] = [];\r\n\t\t}\r\n\t\tthis._callStacks[signal].push({func:func, self:self, once: false});\r\n\t},\r\n\r\n\t// make sure this is the first one get called\r\n\tbindPriority: function(signal, func, self){\r\n\t\tif(!this._callStacks[signal]){\r\n\t\t\tthis._callStacks[signal] = [];\r\n\t\t}\r\n\t\tthis._callStacks[signal].splice(0, 0, {func:func, self:self, once: false});\r\n\t},\r\n\r\n\t// destory the bind after it get called\r\n\tbindOnce: function(signal, func, self){\r\n\t\tif(!this._callStacks[signal]){\r\n\t\t\tthis._callStacks[signal] = [];\r\n\t\t}\r\n\t\tthis._callStacks[signal].push({func:func, self:self, once: true});\r\n\t},\r\n\r\n\t// make sure this is the first one get called destory the bind after it get called\r\n\tbindOncePriority: function(signal, func, self){\r\n\t\tif(!this._callStacks[signal]){\r\n\t\t\tthis._callStacks[signal] = [];\r\n\t\t}\r\n\t\tthis._callStacks[signal].splice(0, 0, {func:func, self:self, once: true});\r\n\t},\r\n\r\n\t// unbind the event\r\n\tunbind: function(signal, func, self){\r\n\t\tif(!this._callStacks[signal]){return;}\r\n\t\tfor(var i = 0; i < this._callStacks[signal].length; i++){\r\n\t\t\tif(this._callStacks[signal][i].func === func && (!self || this._callStacks[signal][i].self === self)){\r\n\t\t\t\tthis._callStacks[signal].splice(i, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(this._callStacks[signal].length <= 0){\r\n\t\t\tthis._callStacks[signal] = undefined;\r\n\t\t}\r\n\t},\r\n\r\n\t// destroy a signal\r\n\tdestroy: function(signal){\r\n\t\tthis._callStacks[signal] = undefined;\r\n\t},\r\n\r\n\t// dispatch the event\r\n\tcall: function(signal, data){\r\n\t\tif(this.debugMode){\r\n\t\t\tif(!this.logger){\r\n\t\t\t\tthis.logger = console.log;\r\n\t\t\t}\r\n\t\t\tthis.logger('CALL: ' + signal, data);\r\n\t\t}\r\n\t\tif(this.lastEvent){\r\n\t\t\tthis.lastEvent.signal = signal;\r\n\t\t\tthis.lastEvent.data = data;\r\n\t\t}else{\r\n\t\t\tthis.lastEvent = {signal: signal, data: data};\r\n\t\t}\r\n\r\n\t\tif(!this._callStacks[signal]){return;}\r\n\t\tvar eves = this._callStacks[signal];\r\n\t\tfor(var i = 0; i < eves.length; i++){\r\n\t\t\tif(eves[i].func){\r\n\t\t\t\teves[i].func.call(eves[i].self, data);\r\n\t\t\t\tif(eves[i]){\r\n\t\t\t\t\teves[i]._processed = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(eves[i].once){\r\n\t\t\t\teves.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(eves.length <= 0){\r\n\t\t\tthis.destroy(signal);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// Aliases\r\nwhevent.on = whevent.bind;\r\nwhevent.onOnce = whevent.bindOnce;\r\nwhevent.onPriority = whevent.bindPriority;\r\nwhevent.onOncePriority = whevent.bindOncePriority;\r\nwhevent.off = whevent.unbind;\r\nwhevent.emit = whevent.call;\r\n\r\nif(typeof module !== 'undefined'){\r\n\tmodule.exports = whevent;\r\n}\r\n"]}